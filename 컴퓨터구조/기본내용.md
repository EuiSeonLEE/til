# 📗 컴퓨터 구조 기본

## ❄️ CPU

중앙 처리 장치로, ROM 으로부터 실행해야될 절차를 읽어 들여서, 읽어 들인 절차를 해석해서 실행한다. 

- PC - Program Counter
    
    ROM 내의 프로그램 중 어디를 참고할지를 관리하는 하드웨어이다. 다음에 실행할 명령을 읽을 위치를 CPU 에 전달하는 역할을한다.
    
- Decoder
    
    읽어들인 명령의 의미를 해독하는 하드웨어이다. 해독한 내용을 토대로 ALU 의 연산이나, 데이터의 이동 등의 구체적인 지시를 CPU 내에서 실행한다.
    
- ALU
    
    사칙연산이나, AND, OR, NOT 등의 논리 연산을 수행하는 회로이다. 디코더에서 명령을 해독한 결과의 연산처리가 필요할때 ALU 를 사용한다. 결과는 범용 레지스터나 시스템 레지스터에 반영이 된다.
    
- General Register
    
    CPU에 내장된 범용 메모리로, 속도가 굉장히 빠르지만, 용량이 굉장히 작다. CPU가 프로그램을 실행할 때 일시적으로 이용하는 메모리이다. ALU 에서 연산 결과를 보관하는 Accumulator 나 데이터 이동할 때의 보관 장소로 이용한다.
    
- System Register
    
    CPU가 명령을 실행할 때에 이용하는 레지스터이다. 
    
    - 명령 레지스터 - 명령을 보관한다.
    - 주소 레지스터 - 번지를 관리한다.
    - 상태 레지스터
        
        ALU에서의 연산 결과 상태나 인터럽트 상태 등 CPU가 어떠한 상태인지를 알 수 있도록 하는 레지스터이다. 여러가지 Flag 들로써 이상여부를 나타낸다.
        
    
### 💧 명령실행
    
1. ROM 으로부터 하나의 명령을 추출하기 (Fetch Cycle)
2. 추출한 명령을 해독해서 실행 준비하기 (Decode Cycle)
3. 명령 실행하기 (Execute Cycle)
4. 명령 실행 결과의 반영 (Write Back Cycle)

명령 실행 후의 데이터를 보관하는 것은 범용 레지스터에 저장하고, 명령 연산 결과의 보관에는 시스템 레지스터가 사용된다. 실행 주기가 끝나면 다음 명령을 수행할 수 있도록 프로그램 카운터가 자동으로 증가된다.

### 💧 명령 종류

- CPU와 메모리 사이에서 데이터를 교환하는 명령

데이터를 취급하는 명령의 대부분은 범용 레지스터를 이용한다. 범용 레지스터에 쓰인 데이터를 메모리에 기록하거나, 메모리에 있는 데이터를 범용 레지스터로 읽어 들인다. 

- CPU와 주변장치 사이에서 데이터를 교환하는 명령

범용 레지스터에 쓰인 데이터를 주변장치의 제어 레지스터에 쓰거나, 주변장치의 레지스터로부터 읽어 들인다.

- CPU안에서만 실행되는 명령

범용 레지스터끼리 서로 데이터를 주거나 받거나 하는 것이고 범용 레지스터에 쓰인 데이터를 연산할 때 ALU 를 사용해서 연산 실행 후 범용 레지스터에 기록되는 것으로 사용할 수 있다.

### 💧 인터럽트

CPU에 주변 장치의 처리 요구를 통지하기 위한 신호이다. 인터럽트 신호를 받으면 인터럽트 벡터 테이블로 실행이 옮겨진다. 여기에서는 각각 정해진 인터럽트 프로그램들의 주소를 가지고 있기 때문에, 해당 번호에 따른 특정 인터럽트 처리로 이동한다. 그 이후 원래의 위치로 돌아와서 동작을 계속 실시한다.

- 타이머 인터럽트 - 타이머로 부터 발생하는 인터럽트이다.
- 외부 인터럽트 - 주변장치 등의 외부 하드웨어로부터 발생하는 인터럽트이다.

인터럽트는 우선순위를 결정해야한다. 여러 인터럽트가 발생할 경우 우선순위가 없으면 어느 인터럽트 요인을 먼저 처리해야할지 CPU는 알지 못하기 때문이다. CPU에 따라서는 우선순위를 결정하기 위한 레지스터가 준비되어있다.

## ❄️ Memory

- ROM
    
    Read Only Memory 로써, CPU 로부터 읽기 요구가 있을 때, 특정 주소의 프로그램을 읽어서 CPU 에 프로그램을 전달하는 역할을 한다. 비휘발성 메모리이다. Mask ROM, Flash 메모리 등이 있다. Flash MEM 는 쓰기 읽기가 가능한 메모리이다. 
    
- RAM
    
    프로그램이 실행할 때 일시적으로 데이터의 보관이 필요할 때 사용한다. 휘발성 메모리이다. SRAM, DRAM 이 있다.
    

## ❄️ Bus

- Main Bus
    
    CPU 와 메모리 혹은 주변장치들과 액세스할 수 있도록 하는 신호선이다. 고속으로 액세스해야하는 하드웨어 장치에 주로 사용한다.
    
    - 주소 버스
        
        메모리나 주변장치에 접근할 수 있도록 하는 특정 주소를 나타내기 위해서 사용되는 신호선이다.
        
    - 데이터 버스
        
        메모리나 주변장치로부터 데이터를 읽어들이기 위한 신호선이다.
        
    - 컨트롤 버스
        
        메모리나 주변장치를 제어하기 위한 신호선이다. 데이터를 읽고 쓰는 타이밍이나, 주변의 장치와 CPU 간의 제어가 필요한 신호를 전달하기 위해서 사용된다. **CLK** 이다! - 칩 셀렉트(어떤 신호가 들어오는지) 나 쓰기 읽기 클럭 신호선
        
- Local Bus
    
    Main Bus 보다 저속으로 동작하는 주변 장치들과 접속할 때 주로 사용된다. 
    
- Bridge
    
    메인버스와 로컬 버스를 연결시켜주는 컨트롤러를 이야기한다. 로컬 버스와 메인버스의 속도차를 해결해주는 역할을 한다. 저속의 로컬 버스로 받은 데이터를 관리하고, 고속의 메인버스의 속도에 맞춰서 데이터를 송수신 해주는 하드웨어다.
    

# 📘 주변 장치

## ❄️ DMA

CPU가 메모리에 직접 정보를 읽고 또한 쓰는 것에 관여를 한다면, CPU 는 그 시간동안 다른 연산의 수행을 할 수 없다. (**PIO - Programmed I/O 방식**) 그래서 DMA(Direct Memory Access)를 사용해서 메모리를 읽어오거나 쓰는 것을 할 수 있도록 하고, CPU는 그 동안에 다른 처리를 할 수 있도록 하는 방식이다.

이때 버스를 누구라도 자유롭게 사용하기 때문에 교통정리를 해주는 이가 필요한데, 그것이 **버스 아비터**이다. 버스 아비터가 데이터가 충돌하지 않도록 해준다.

etc -  Timer, RTC, GPIO 등

## ❄️ 주변 장치의 제어방식

일반적으로 Register 를 통해서 CPU 로부터 제어를 한다. 

- Memory Mapped I/O
    
    ROM, RAM 의 주소 형식과 같이 특정주소에 주변장치가 사용하는 구간으로 설정하고 그 주소에 접근함으로써 주변장치의 레지스터를 제어하는 방법이다.
    
- I/O Mapped I/O
    
    ROM, RAM 을 접근하는 주소의 형식과는 달리 전용의 명령어를 통해서 주변장치 레지스터를 제어하는 방식이다.